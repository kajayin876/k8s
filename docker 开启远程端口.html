<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.7.24 (476601)"/><meta name="author" content="k1mcu740"/><meta name="created" content="2022-10-06 13:48:19 +0000"/><meta name="source" content="desktop.win"/><meta name="source-application" content="yinxiang.win32"/><meta name="source-url" content="https://www.cnblogs.com/hongdada/p/11512901.html"/><meta name="updated" content="2022-10-06 13:49:00 +0000"/><title>docker 开启远程端口</title></head><body><div><h1 style="margin: 0px; padding: 0px; font-size: 21px; color: rgb(49, 70, 89); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><a href="https://www.cnblogs.com/hongdada/p/11512901.html" style="font-size: 21px; color: var(--text-color); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); vertical-align: middle;">Docker开启Remote API 访问 2375端口</a></h1><div style="margin: 0px; padding: 0px; font-size: 16px; line-height: 1.75; color: rgb(49, 70, 89); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><div style="margin: 0px 0px 20px; padding: 0px; word-break: break-word;"><h2 style="margin: 10px 0px; padding: 0px; font-size: 20px; font-weight: bold; line-height: 1.5;"><span style="font-size: 20px; font-weight: bold; line-height: 1.5;">Docker常见端口</span><a href="https://www.cnblogs.com/hongdada/p/11512901.html#docker%E5%B8%B8%E8%A7%81%E7%AB%AF%E5%8F%A3" style="font-size: 20px; font-weight: bold; line-height: 1.5; color: var(--theme-color); opacity: 0;">#</a></h2><div style="margin: 13px auto; padding: 0px; text-indent: 0px;"><span style="text-indent: 0px;">我看到的常见docker端口包括：</span></div><blockquote style="margin: 15px 0px; padding: 1px 10px; background-image: none; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: var(--panel-bg-color); border-top: none; border-right: none; border-bottom: none; border-left: 4px solid var(--theme-color); border-image: initial; color: rgb(85, 85, 85); border-radius: 4px;"><p style="margin: 13px auto; padding: 0px; text-indent: 0px;"/><div>2375：未加密的docker socket,远程root无密码访问主机</div><div>2376：tls加密套接字,很可能这是您的CI服务器4243端口作为https 443端口的修改</div><div>2377：群集模式套接字,适用于群集管理器,不适用于docker客户端</div><div>5000：docker注册服务</div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;">4789和7946：覆盖网络</span></div></blockquote><h2 style="margin: 10px 0px; padding: 0px; font-size: 20px; font-weight: bold; line-height: 1.5;"><span style="font-size: 20px; font-weight: bold; line-height: 1.5;">开启配置</span><a href="https://www.cnblogs.com/hongdada/p/11512901.html#%E5%BC%80%E5%90%AF%E9%85%8D%E7%BD%AE" style="font-size: 20px; font-weight: bold; line-height: 1.5; color: var(--theme-color); opacity: 0;">#</a></h2><h3 style="margin: 10px 0px; padding: 0px; font-size: 19px; font-weight: bold; line-height: 1.5;"><span style="font-size: 19px; font-weight: bold; line-height: 1.5;">方法一</span><a href="https://www.cnblogs.com/hongdada/p/11512901.html#%E6%96%B9%E6%B3%95%E4%B8%80" style="font-size: 19px; font-weight: bold; line-height: 1.5; color: var(--theme-color); opacity: 0;">#</a></h3><div style="margin: 13px auto; padding: 0px; text-indent: 0px;"><span style="text-indent: 0px;">首先是怎么配置远程访问的API：</span></div><div style="margin: 10px auto; padding: 0px; transition-duration: 0.2s; transition-property: color, opacity, padding-top, padding-bottom, margin-top, margin-bottom, height; overflow: auto; white-space: pre; position: relative;"><div style="margin: 0px; transition-duration: 0.2s; transition-property: color, opacity, border-color, padding-top, padding-bottom, margin-top, margin-bottom, height; color: rgb(186, 186, 186); border-radius: 3px; overflow-x: auto; line-height: 1.5; white-space: pre-wrap; padding: 0.5em 1em 0.5em 3em !important; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace !important; background: rgb(43, 43, 43) !important; font-size: 15px !important; border: 1px solid rgb(44, 42, 42) !important;"><span style="color: rgb(186, 186, 186); border-radius: 3px; overflow-x: auto; line-height: 1.5; white-space: pre-wrap; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace !important; background: rgb(43, 43, 43) !important; font-size: 15px !important; border: 1px solid rgb(44, 42, 42) !important;">sudo vim /etc/default/docker</span></div></div><div style="margin: 13px auto; padding: 0px; text-indent: 0px;"><span style="text-indent: 0px;">加入下面一行</span></div><div style="margin: 10px auto; padding: 0px; transition-duration: 0.2s; transition-property: color, opacity, padding-top, padding-bottom, margin-top, margin-bottom, height; overflow: auto; white-space: pre; position: relative;"><div style="margin: 0px; transition-duration: 0.2s; transition-property: color, opacity, border-color, padding-top, padding-bottom, margin-top, margin-bottom, height; color: rgb(186, 186, 186); border-radius: 3px; overflow-x: auto; line-height: 1.5; white-space: pre-wrap; padding: 0.5em 1em 0.5em 3em !important; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace !important; background: rgb(43, 43, 43) !important; font-size: 15px !important; border: 1px solid rgb(44, 42, 42) !important;"><span style="color: rgb(209, 154, 102); border-radius: 3px; overflow-x: auto; line-height: 1.5; white-space: pre-wrap; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace !important; background: rgb(43, 43, 43) !important; font-size: 15px !important; border: 1px solid rgb(44, 42, 42) !important;">DOCKER_OPTS</span><span style="color: rgb(186, 186, 186); border-radius: 3px; overflow-x: auto; line-height: 1.5; white-space: pre-wrap; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace !important; background: rgb(43, 43, 43) !important; font-size: 15px !important; border: 1px solid rgb(44, 42, 42) !important;">=</span><span style="color: rgb(152, 195, 121); border-radius: 3px; overflow-x: auto; line-height: 1.5; white-space: pre-wrap; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace !important; background: rgb(43, 43, 43) !important; font-size: 15px !important; border: 1px solid rgb(44, 42, 42) !important;">"-H <a href="tcp://0.0.0.0:2375/">tcp://0.0.0.0:2375</a>"</span></div></div><div style="margin: 13px auto; padding: 0px; text-indent: 0px;"><span style="text-indent: 0px;">重启docker即可：</span></div><div style="margin: 10px auto; padding: 0px; transition-duration: 0.2s; transition-property: color, opacity, padding-top, padding-bottom, margin-top, margin-bottom, height; overflow: auto; white-space: pre; position: relative;"><div style="margin: 0px; transition-duration: 0.2s; transition-property: color, opacity, border-color, padding-top, padding-bottom, margin-top, margin-bottom, height; color: rgb(186, 186, 186); border-radius: 3px; overflow-x: auto; line-height: 1.5; white-space: pre-wrap; padding: 0.5em 1em 0.5em 3em !important; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace !important; background: rgb(43, 43, 43) !important; font-size: 15px !important; border: 1px solid rgb(44, 42, 42) !important;"><span style="color: rgb(186, 186, 186); border-radius: 3px; overflow-x: auto; line-height: 1.5; white-space: pre-wrap; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace !important; background: rgb(43, 43, 43) !important; font-size: 15px !important; border: 1px solid rgb(44, 42, 42) !important;">sudo systemctl restart docker</span></div></div><blockquote style="margin: 15px 0px; padding: 1px 10px; background-image: none; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: var(--panel-bg-color); border-top: none; border-right: none; border-bottom: none; border-left: 4px solid var(--theme-color); border-image: initial; color: rgb(85, 85, 85); border-radius: 4px;"><div style="margin: 13px auto; padding: 0px; text-indent: 0px;"><span style="text-indent: 0px;">PS:这是网上给的配置方法，也是这种简单配置让Docker Daemon把服务暴露在tcp的2375端口上，这样就可以在网络上操作Docker了。Docker本身没有身份认证的功能，只要网络上能访问到服务端口，就可以操作Docker。</span></div></blockquote><h3 style="margin: 10px 0px; padding: 0px; font-size: 19px; font-weight: bold; line-height: 1.5;"><span style="font-size: 19px; font-weight: bold; line-height: 1.5;">方法二</span><a href="https://www.cnblogs.com/hongdada/p/11512901.html#%E6%96%B9%E6%B3%95%E4%BA%8C" style="font-size: 19px; font-weight: bold; line-height: 1.5; color: var(--theme-color); opacity: 0;">#</a></h3><div style="margin: 13px auto; padding: 0px; text-indent: 0px;"><span style="text-indent: 0px;">在/usr/lib/systemd/system/docker.service，配置远程访问。</span></div><div style="margin: 13px auto; padding: 0px; text-indent: 0px;"><span style="text-indent: 0px;">主要是在[Service]这个部分，加上下面两个参数</span></div><div style="margin: 10px auto; padding: 0px; transition-duration: 0.2s; transition-property: color, opacity, padding-top, padding-bottom, margin-top, margin-bottom, height; overflow: auto; white-space: pre; position: relative;"><div style="margin: 0px; transition-duration: 0.2s; transition-property: color, opacity, border-color, padding-top, padding-bottom, margin-top, margin-bottom, height; color: rgb(186, 186, 186); border-radius: 3px; overflow-x: auto; line-height: 1.5; white-space: pre-wrap; padding: 0.5em 1em 0.5em 3em !important; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace !important; background: rgb(43, 43, 43) !important; font-size: 15px !important; border: 1px solid rgb(44, 42, 42) !important;"><div><span style="color: rgb(92, 99, 112); font-style: italic;"># vim /usr/lib/systemd/system/docker.service</span><span style="color: rgb(224, 108, 117);">[Service]</span><span style="color: rgb(209, 154, 102);">ExecStart</span>=</div><div><span style="color: rgb(209, 154, 102);">ExecStart</span>=/usr/bin/dockerd -H tcp://<span style="color: rgb(209, 154, 102);">0.0</span>.<span style="color: rgb(209, 154, 102);">0.0</span>:<span style="color: rgb(209, 154, 102);">2375</span> -H <a href="unix://var/run/docker.sock">unix://var/run/docker.sock</a></div></div></div><div style="margin: 13px auto; padding: 0px; text-indent: 0px;"><span style="text-indent: 0px;">重启</span></div><div style="margin: 10px auto; padding: 0px; transition-duration: 0.2s; transition-property: color, opacity, padding-top, padding-bottom, margin-top, margin-bottom, height; overflow: auto; white-space: pre; position: relative;"><div style="margin: 0px; transition-duration: 0.2s; transition-property: color, opacity, border-color, padding-top, padding-bottom, margin-top, margin-bottom, height; color: rgb(186, 186, 186); border-radius: 3px; overflow-x: auto; line-height: 1.5; white-space: pre-wrap; padding: 0.5em 1em 0.5em 3em !important; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace !important; background: rgb(43, 43, 43) !important; font-size: 15px !important; border: 1px solid rgb(44, 42, 42) !important;"><div>systemctl daemon-reload</div><div>systemctl restart docker</div></div></div><h3 style="margin: 10px 0px; padding: 0px; font-size: 19px; font-weight: bold; line-height: 1.5;"><span style="font-size: 19px; font-weight: bold; line-height: 1.5;">方法三</span><a href="https://www.cnblogs.com/hongdada/p/11512901.html#%E6%96%B9%E6%B3%95%E4%B8%89" style="font-size: 19px; font-weight: bold; line-height: 1.5; color: var(--theme-color); opacity: 0;">#</a></h3><div style="margin: 13px auto; padding: 0px; text-indent: 0px;"><span style="text-indent: 0px;">下面修改</span><span style="text-indent: 0px; font-family: consolas !important; font-size: 14px !important; line-height: 1.2; display: inline-block; overflow-x: auto; vertical-align: middle; border-radius: 3px !important; background-color: var(--code-bg-color) !important; color: rgb(232, 62, 140); border: none !important;">daemon.json</span><span style="text-indent: 0px;">的配置</span></div><div style="margin: 10px auto; padding: 0px; transition-duration: 0.2s; transition-property: color, opacity, padding-top, padding-bottom, margin-top, margin-bottom, height; overflow: auto; white-space: pre; position: relative;"><div style="margin: 0px; transition-duration: 0.2s; transition-property: color, opacity, border-color, padding-top, padding-bottom, margin-top, margin-bottom, height; color: rgb(186, 186, 186); border-radius: 3px; overflow-x: auto; line-height: 1.5; white-space: pre-wrap; padding: 0.5em 1em 0.5em 3em !important; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace !important; background: rgb(43, 43, 43) !important; font-size: 15px !important; border: 1px solid rgb(44, 42, 42) !important;"><div>vim /etc/docker/daemon.json</div><div><br/></div><div>{</div><div><span style="color: rgb(152, 195, 121);">"hosts"</span>: [<span style="color: rgb(152, 195, 121);">"<a href="tcp://0.0.0.0:2375/">tcp://0.0.0.0:2375</a>"</span>, <span style="color: rgb(152, 195, 121);">"unix:///var/run/docker.sock"</span>]</div><div>}</div></div></div><blockquote style="margin: 15px 0px; padding: 1px 10px; background-image: none; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: var(--panel-bg-color); border-top: none; border-right: none; border-bottom: none; border-left: 4px solid var(--theme-color); border-image: initial; color: rgb(85, 85, 85); border-radius: 4px;"><p style="margin: 13px auto; padding: 0px; text-indent: 0px;"/><div>"unix:///var/run/docker.sock"：unix socket，本地客户端将通过这个来连接 Docker Daemon。</div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;">"<a href="tcp://0.0.0.0:2375/">tcp://0.0.0.0:2375</a>"：tcp socket，表示允许任何远程客户端通过 2375 端口连接 Docker Daemon。</span></div></blockquote><div style="margin: 13px auto; padding: 0px; text-indent: 0px;"><span style="text-indent: 0px;">修改配置以后</span></div><div style="margin: 13px auto; padding: 0px; text-indent: 0px;"><span style="text-indent: 0px;">然后让docker重新读取配置文件,并重启docker服务</span></div><div style="margin: 10px auto; padding: 0px; transition-duration: 0.2s; transition-property: color, opacity, padding-top, padding-bottom, margin-top, margin-bottom, height; overflow: auto; white-space: pre; position: relative;"><div style="margin: 0px; transition-duration: 0.2s; transition-property: color, opacity, border-color, padding-top, padding-bottom, margin-top, margin-bottom, height; color: rgb(186, 186, 186); border-radius: 3px; overflow-x: auto; line-height: 1.5; white-space: pre-wrap; padding: 0.5em 1em 0.5em 3em !important; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace !important; background: rgb(43, 43, 43) !important; font-size: 15px !important; border: 1px solid rgb(44, 42, 42) !important;"><div>systemctl daemon-reload</div><div>systemctl restart docker</div></div></div><div style="margin: 13px auto; padding: 0px; text-indent: 0px;"><span style="text-indent: 0px;">查看docker进程：</span></div><div style="margin: 10px auto; padding: 0px; transition-duration: 0.2s; transition-property: color, opacity, padding-top, padding-bottom, margin-top, margin-bottom, height; overflow: auto; white-space: pre; position: relative;"><div style="margin: 0px; transition-duration: 0.2s; transition-property: color, opacity, border-color, padding-top, padding-bottom, margin-top, margin-bottom, height; color: rgb(186, 186, 186); border-radius: 3px; overflow-x: auto; line-height: 1.5; white-space: pre-wrap; padding: 0.5em 1em 0.5em 3em !important; font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace !important; background: rgb(43, 43, 43) !important; font-size: 15px !important; border: 1px solid rgb(44, 42, 42) !important;"><div>[root@slaver2 ~]<span style="color: rgb(92, 99, 112); font-style: italic;"># ps -ef|grep docker</span></div><div>root <span style="color: rgb(209, 154, 102);">44221</span> <span style="color: rgb(209, 154, 102);">1</span> <span style="color: rgb(209, 154, 102);">1</span> <span style="color: rgb(209, 154, 102);">18</span>:<span style="color: rgb(209, 154, 102);">16</span> ? <span style="color: rgb(209, 154, 102);">00</span>:<span style="color: rgb(209, 154, 102);">00</span>:<span style="color: rgb(209, 154, 102);">06</span> /usr/bin/dockerd -H tcp:<span style="color: rgb(152, 195, 121);">//</span><span style="color: rgb(209, 154, 102);">0</span>.<span style="color: rgb(209, 154, 102);">0</span>.<span style="color: rgb(209, 154, 102);">0</span>.<span style="color: rgb(209, 154, 102);">0</span>:<span style="color: rgb(209, 154, 102);">2375</span> -H unix:<span style="color: rgb(152, 195, 121);">//</span>var/run/docker.sock</div></div></div><div style="margin: 13px auto; padding: 0px; text-indent: 0px;"><span style="text-indent: 0px;">Docker守护进程打开一个HTTP Socket,这样才能实现远程通信</span></div></div></div><div><br/></div></div></body></html>