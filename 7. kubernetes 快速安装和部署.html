<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.7.24 (476601)"/><meta name="author" content="k1mcu740"/><meta name="created" content="2023-08-30 14:27:21 +0000"/><meta name="source" content="desktop.win"/><meta name="source-application" content="yinxiang.win32"/><meta name="source-url" content="https://www.jianshu.com/p/b1ec72e6f91f"/><meta name="updated" content="2023-08-31 12:37:21 +0000"/><title>7. kubernetes 快速安装和部署</title></head><body><div><div><div><div><div><div><span style="font-size: 24pt;">1.部署</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;1.1 物理机环境</span></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/><col style="width: 140px;"/><col style="width: 130px;"/></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>&nbsp;&nbsp;地址</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>版本</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 140px; padding: 8px;"><div>cpu/内存</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>hostname</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div><span style="color: rgb(23, 26, 29);">192.168.56.102</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>centos 7.9</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 140px; padding: 8px;"><div>4000m/8GB</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>k8s-master</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div><span style="color: rgb(23, 26, 29);">192.168.56.103</span></div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>centos 7.9</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 140px; padding: 8px;"><div>4000m/8GB</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>k8s-node1</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>192.168.56.104</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>centos 7.9</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 140px; padding: 8px;"><div>4000m/8GB</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>k8s-node2</div></td></tr></tbody></table><div><span style="font-size: 18pt; color: unset; font-family: unset;">备注：kubernetes 软件版本是</span><span style="font-size: 18pt;">1.28.1</span></div></div><div><span style="font-size: 18pt;">每台主机都要按照下面操作执行一遍（另外一种方案，初始化好环境后用虚拟机复制出来，这样初始化操作只需要执行一次可以）</span></div><div><span style="font-size: 18pt;"><br/></span></div><div><span style="font-size: 18pt;"><br/></span></div><div><span style="font-size: 18pt;">1.2</span> <font style="font-size: 18pt;"><span style="font-size: 18pt;">初始化centos kubernetes源镜像（</span><span style="white-space: pre; font-size: 18pt;">阿里云源</span><span style="font-size: 18pt;">）</span></font></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div><span style="font-size: 18pt;">cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo</span></div><div><span style="font-size: 18pt;">[kubernetes]</span></div><div><span style="font-size: 18pt;">name=Kubernetes</span></div><div><span style="font-size: 18pt;">baseurl=</span><a href="http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64" style="font-size: 18pt;">http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64</a></div><div><span style="font-size: 18pt;">enabled=1</span></div><div><span style="font-size: 18pt;">gpgcheck=0</span></div><div><span style="font-size: 18pt;">repo_gpgcheck=0</span></div><div><span style="font-size: 18pt;">gpgkey=</span><a href="http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg" style="font-size: 18pt;">http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg</a></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg" style="font-size: 18pt;">http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg</a></div><div style="white-space: pre;"><span style="white-space: pre;"><span style="font-size: 18pt;">EOF</span></span></div><div><span style="font-size: 18pt;">1.3 centos 源更新</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;配置更改完后，需要更新源 yum update </span></div><div><span style="font-size: 18pt;">1.4 安装源工具</span></div><ul><li><div><span style="font-size: 18pt;">sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span></div></li><li><div><span style="font-size: 18pt;">yum-config-manager&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--add-repo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo" style="font-size: 18pt;">http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</a></span></div></li><li><div><span style="font-size: 18pt;">yum install docker-ce-20.10.13 （切记版本用20版本，低版本环境会有问题）</span></div></li></ul><div><span style="font-size: 18pt;">1.5&nbsp;&nbsp;</span><span style="font-size: 18pt;">安装&nbsp;&nbsp;</span> <span style="font-size: 18pt;">yum install -y kubelet-</span><span style="font-size: 18pt;">1.23.5</span> <span style="font-size: 18pt;">kubeadm-</span><span style="font-size: 18pt;">1.23.5</span> <span style="font-size: 18pt;">kubectl-</span><span style="font-size: 18pt;">1.23.5</span></div><div><span style="font-size: 18pt;">1.6&nbsp;&nbsp;</span><span style="white-space: pre;"><span style="font-size: 18pt;">centos kubernetes 开机启动启动 (每次服务器启动后服务都是启动状态)</span></span></div><ul><li><div style="white-space: pre;"><span style="white-space: pre;"><span style="font-size: 18pt;">systemctl enable kubelet &amp;&amp; systemctl start kubelet</span></span></div></li><li><div style="white-space: pre;"><span style="white-space: pre;"><span style="font-size: 18pt;">systemctl enable docker &amp;&amp; systemctl start docker</span></span></div></li><li><div style="white-space: pre;"><span style="font-size: 18pt;">systemctl disable firewalld (关闭开机启动)</span></div></li></ul><div><span style="font-size: 18pt;">1.7 centos docker初始化配置</span></div><ul><li><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size: 18pt;">modprobe br_netfilter</span></div></li><li><div><span style="font-size: 18pt;">vim /etc/docker/daemon.json 增加配置</span><span style="font-size: 18pt;">{"exec-opts":["native.cgroupdriver=systemd"] }&nbsp;&nbsp;</span></div></li><li><div><span style="font-size: 18pt;"><img src="7.%20kubernetes%20%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85%E5%92%8C%E9%83%A8%E7%BD%B2.resources/F8E8A1A6-5EEA-4D06-8049-E82AFFDFDD37.png" height="191" width="355"/></span></div></li></ul><div><span style="font-size: 18pt;"><br/></span></div><div><span style="font-size: 18pt;"><br/></span></div><div><span style="font-size: 18pt;"><br/></span></div><div><span style="font-size: 18pt;">1.8 centos hostname 修改</span></div></div><ul><li><div><span style="font-size: 18pt;">vi /etc/hostname&nbsp;&nbsp; （每个节点要按照1.1表格hostname配置，每个centos服务器都要对应一个唯一hostname）</span></div></li></ul><div><span style="font-size: 18pt;"><img src="7.%20kubernetes%20%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85%E5%92%8C%E9%83%A8%E7%BD%B2.resources/F9A9DF63-C347-40F1-A5C9-1EAB4C5C018F.png" height="41" width="229"/></span></div><ul><li><div><span style="font-size: 18pt;">配置好参数后，每个节点都要重启</span></div></li></ul><div><span style="font-size: 18pt;">1.9 centos 初始化</span></div><ul><li><div><span style="font-size: 18pt;">service firewalld stop</span></div></li><li><div><span style="font-size: 18pt;">swapoff&nbsp;&nbsp;&nbsp;&nbsp;-a （如果服务器重启，必须再次执行该命令。把内存交换关闭）</span></div></li><li><div><span style="font-size: 18pt;">rm /etc/containerd/config.toml</span></div></li><li><div style="white-space: pre;"><span style="white-space: pre; font-size: 18pt;">systemctl restart containerd</span></div></li><li><div><span style="font-size: 18pt;">vi /etc/hosts</span></div></li><li><div><span style="font-size: 18pt;"><img src="7.%20kubernetes%20%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85%E5%92%8C%E9%83%A8%E7%BD%B2.resources/E2C3F5A0-F564-49DD-B183-9196DD452313.png" height="65" width="576"/></span></div></li><li><div><span style="font-size: 18pt;">service kubelet start</span></div></li></ul><div><span style="font-size: 18pt;">1.9&nbsp;&nbsp;</span><span style="font-size: 18pt;">kubernetes 初始化集群</span></div></div><ul><li><div><span style="font-size: 18pt;">kubeadm init --apiserver-advertise-address=192.168.56.102 --image-repository</span> <a href="http://registry.aliyuncs.com/google_containers" style="font-size: 18pt;">registry.aliyuncs.com/google_containers</a><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;--kubernetes-version=v1.23.5 --pod-network-cidr=10.244.0.0/16 --service-cidr=10.96.0.0/12</span></div></li></ul><div><span style="font-size: 18pt;">1.10 安装好后，可以把node节点加入主节点</span></div><ul><li><div><span style="font-size: 18pt;">&nbsp;&nbsp;</span><span style="font-size: 18pt;">kubeadm join 192.168.56.102:6443 --token gm0bxi.8jra298kxol8judx \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--discovery-token-ca-cert-hash sha256:24dbd23e79a41df4cdc8fa0bc915d367db7754a36bfbb91b3cd3ece62b021909<span>&nbsp;&nbsp;</span></span></div></li></ul></div><ul><li><div><span style="font-size: 18pt;">如果重新创建join的话，命令执行</span> <font style="font-size: 18pt;"><span style="color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal;">&nbsp;&nbsp;</span><span style="color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-ligatures: no-common-ligatures; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal;">kubeadm token create --print-join-command</span></font></div></li></ul><div><span style="font-size: 18pt;">1.11&nbsp;&nbsp; 配置参数</span></div><ul><li><div><span style="font-size: 18pt; color: unset; font-family: unset;">echo "export KUBECONFIG=/etc/kubernetes/admin.conf" &gt;&gt; ~/.bash_profile</span></div></li><li><div><span style="box-sizing: border-box; overflow: visible; overflow-wrap: normal; border-radius: 3px; position: relative; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background: transparent; border: 0px; white-space: pre; word-break: normal;"><span style="background-color: transparent; color: rgb(56, 58, 66); font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1.45; font-size: 18pt;">source ~/.bash_profile</span></span></div></li></ul><div><span style="font-size: 18pt;"><br/></span></div><div><span style="font-size: 18pt;">1.12 配置网络vi cni.yml 把下面内容拷贝进去执行</span> <span style="font-size: 18pt;">kubectl&nbsp;&nbsp;&nbsp;&nbsp;apply -f cni.yml</span></div><div><span style="font-size: 18pt;"><br/></span></div><div><span style="font-size: 18pt;">---</span></div><div><span style="font-size: 18pt;">apiVersion: policy/v1beta1</span></div><div><span style="font-size: 18pt;">kind: PodSecurityPolicy</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: psp.flannel.unprivileged</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;annotations:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seccomp.security.alpha.kubernetes.io/allowedProfileNames: docker/default</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seccomp.security.alpha.kubernetes.io/defaultProfileName: docker/default</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apparmor.security.beta.kubernetes.io/allowedProfileNames: runtime/default</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;apparmor.security.beta.kubernetes.io/defaultProfileName: runtime/default</span></div><div><span style="font-size: 18pt;">spec:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;privileged: false</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;volumes:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- configMap</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- secret</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- emptyDir</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- hostPath</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;allowedHostPaths:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- pathPrefix: "/etc/cni/net.d"</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- pathPrefix: "/etc/kube-flannel"</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- pathPrefix: "/run/flannel"</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;readOnlyRootFilesystem: false</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;# Users and groups</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;runAsUser:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rule: RunAsAny</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;supplementalGroups:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rule: RunAsAny</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;fsGroup:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rule: RunAsAny</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;# Privilege Escalation</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;allowPrivilegeEscalation: false</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;defaultAllowPrivilegeEscalation: false</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;# Capabilities</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;allowedCapabilities: ['NET_ADMIN', 'NET_RAW']</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;defaultAddCapabilities: []</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;requiredDropCapabilities: []</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;# Host namespaces</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;hostPID: false</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;hostIPC: false</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;hostNetwork: true</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;hostPorts:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- min: 0</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max: 65535</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;# SELinux</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;seLinux:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# SELinux is unused in CaaSP</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rule: 'RunAsAny'</span></div><div><span style="font-size: 18pt;">---</span></div><div><span style="font-size: 18pt;">kind: ClusterRole</span></div><div><span style="font-size: 18pt;">apiVersion: rbac.authorization.k8s.io/v1</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: flannel</span></div><div><span style="font-size: 18pt;">rules:</span></div><div><span style="font-size: 18pt;">- apiGroups: ['extensions']</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;resources: ['podsecuritypolicies']</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;verbs: ['use']</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;resourceNames: ['psp.flannel.unprivileged']</span></div><div><span style="font-size: 18pt;">- apiGroups:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- ""</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;resources:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- pods</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;verbs:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- get</span></div><div><span style="font-size: 18pt;">- apiGroups:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- ""</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;resources:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- nodes</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;verbs:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- list</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- watch</span></div><div><span style="font-size: 18pt;">- apiGroups:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- ""</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;resources:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- nodes/status</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;verbs:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- patch</span></div><div><span style="font-size: 18pt;">---</span></div><div><span style="font-size: 18pt;">kind: ClusterRoleBinding</span></div><div><span style="font-size: 18pt;">apiVersion: rbac.authorization.k8s.io/v1</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: flannel</span></div><div><span style="font-size: 18pt;">roleRef:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;apiGroup: rbac.authorization.k8s.io</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;kind: ClusterRole</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: flannel</span></div><div><span style="font-size: 18pt;">subjects:</span></div><div><span style="font-size: 18pt;">- kind: ServiceAccount</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: flannel</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;namespace: kube-system</span></div><div><span style="font-size: 18pt;">---</span></div><div><span style="font-size: 18pt;">apiVersion: v1</span></div><div><span style="font-size: 18pt;">kind: ServiceAccount</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: flannel</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;namespace: kube-system</span></div><div><span style="font-size: 18pt;">---</span></div><div><span style="font-size: 18pt;">kind: ConfigMap</span></div><div><span style="font-size: 18pt;">apiVersion: v1</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: kube-flannel-cfg</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;namespace: kube-system</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;labels:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tier: node</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app: flannel</span></div><div><span style="font-size: 18pt;">data:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;cni-conf.json: |</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"name": "cbr0",</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"cniVersion": "0.3.1",</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"plugins": [</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"type": "flannel",</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"delegate": {</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"hairpinMode": true,</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"isDefaultGateway": true</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"type": "portmap",</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"capabilities": {</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"portMappings": true</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;net-conf.json: |</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Network": "10.244.0.0/16",</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Backend": {</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Type": "vxlan"</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></div><div><span style="font-size: 18pt;">---</span></div><div><span style="font-size: 18pt;">apiVersion: apps/v1</span></div><div><span style="font-size: 18pt;">kind: DaemonSet</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: kube-flannel-ds</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;namespace: kube-system</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;labels:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tier: node</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app: flannel</span></div><div><span style="font-size: 18pt;">spec:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;selector:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matchLabels:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app: flannel</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;template:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;labels:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tier: node</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app: flannel</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spec:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;affinity:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nodeAffinity:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;requiredDuringSchedulingIgnoredDuringExecution:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nodeSelectorTerms:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- matchExpressions:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- key: kubernetes.io/os</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;operator: In</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- linux</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hostNetwork: true</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;priorityClassName: system-node-critical</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tolerations:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- operator: Exists</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;effect: NoSchedule</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;serviceAccountName: flannel</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initContainers:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: install-cni-plugin</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#image: flannelcni/flannel-cni-plugin:v1.1.0 for ppc64le and mips64le (dockerhub limitations may apply)</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image: rancher/mirrored-flannelcni-flannel-cni-plugin:v1.1.0</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;command:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- cp</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- -f</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- /flannel</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- /opt/cni/bin/flannel</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;volumeMounts:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: cni-plugin</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mountPath: /opt/cni/bin</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: install-cni</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#image: flannelcni/flannel:v0.18.1 for ppc64le and mips64le (dockerhub limitations may apply)</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image: rancher/mirrored-flannelcni-flannel:v0.18.1</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;command:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- cp</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- -f</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- /etc/kube-flannel/cni-conf.json</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- /etc/cni/net.d/10-flannel.conflist</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;volumeMounts:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: cni</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mountPath: /etc/cni/net.d</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: flannel-cfg</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mountPath: /etc/kube-flannel/</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;containers:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: kube-flannel</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#image: flannelcni/flannel:v0.18.1 for ppc64le and mips64le (dockerhub limitations may apply)</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image: rancher/mirrored-flannelcni-flannel:v0.18.1</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;command:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- /opt/bin/flanneld</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;args:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- --ip-masq</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- --kube-subnet-mgr</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resources:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;requests:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cpu: "100m"</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memory: "50Mi"</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limits:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cpu: "100m"</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memory: "50Mi"</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;securityContext:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;privileged: false</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;capabilities:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add: ["NET_ADMIN", "NET_RAW"]</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;env:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: POD_NAME</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;valueFrom:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fieldRef:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fieldPath: metadata.name</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: POD_NAMESPACE</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;valueFrom:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fieldRef:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fieldPath: metadata.namespace</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: EVENT_QUEUE_DEPTH</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value: "5000"</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;volumeMounts:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: run</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mountPath: /run/flannel</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: flannel-cfg</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mountPath: /etc/kube-flannel/</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: xtables-lock</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mountPath: /run/xtables.lock</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;volumes:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: run</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hostPath:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /run/flannel</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: cni-plugin</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hostPath:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /opt/cni/bin</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: cni</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hostPath:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /etc/cni/net.d</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: flannel-cfg</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;configMap:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: kube-flannel-cfg</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- name: xtables-lock</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hostPath:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /run/xtables.lock</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type: FileOrCreate</span></div><div><span style="font-size: 18pt;"><br/></span></div><div><br/></div></div><div><span style="font-size: 18pt;">1.13 检查</span><span style="font-size: 18pt;">kubectl get node 所有主机节点都需要执行加入操作</span></div><div><span style="font-size: 18pt;"><img src="7.%20kubernetes%20%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85%E5%92%8C%E9%83%A8%E7%BD%B2.resources/10B8C6A1-5A0F-4C49-9A39-AD5582F009DC.png" height="81" width="447"/></span></div><div><span style="font-size: 18pt;">1.14 所有的pod命令</span><span style="font-size: 18pt;">kubectl get pod --all-namespaces</span></div><div><span style="font-size: 18pt;"><img src="7.%20kubernetes%20%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85%E5%92%8C%E9%83%A8%E7%BD%B2.resources/768ED3C2-42B2-432D-BA65-DDB129740723.png" height="238" width="707"/></span></div><div><span style="font-size: 18pt;"><br/></span></div></body></html>