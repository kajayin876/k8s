<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.7.24 (476601)"/><meta name="author" content="k1mcu740"/><meta name="created" content="2023-08-31 12:38:00 +0000"/><meta name="source" content="desktop.win"/><meta name="source-application" content="yinxiang.win32"/><meta name="updated" content="2023-08-31 13:12:21 +0000"/><title>8. kubernetes dashboard 控制台私有化部署</title></head><body><div><span style="font-size: 18pt;">1.执行dashboard配置文件</span></div><div><span style="font-size: 18pt;">apiVersion: v1</span></div><div><span style="font-size: 18pt;">kind: ServiceAccount</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;labels:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k8s-app: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;namespace: kube-system</span></div><div><span style="font-size: 18pt;">---</span></div><div><span style="font-size: 18pt;">apiVersion: rbac.authorization.k8s.io/v1</span></div><div><span style="font-size: 18pt;">kind: ClusterRole</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;labels:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k8s-app: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rbac.authorization.k8s.io/aggregate-to-admin: "true"</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rbac.authorization.k8s.io/aggregate-to-edit: "true"</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rbac.authorization.k8s.io/aggregate-to-view: "true"</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: system:aggregated-metrics-reader</span></div><div><span style="font-size: 18pt;">rules:</span></div><div><span style="font-size: 18pt;">- apiGroups:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- metrics.k8s.io</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;resources:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- pods</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- nodes</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;verbs:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- get</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- list</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- watch</span></div><div><span style="font-size: 18pt;">---</span></div><div><span style="font-size: 18pt;">apiVersion: rbac.authorization.k8s.io/v1</span></div><div><span style="font-size: 18pt;">kind: ClusterRole</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;labels:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k8s-app: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: system:metrics-server</span></div><div><span style="font-size: 18pt;">rules:</span></div><div><span style="font-size: 18pt;">- apiGroups:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- ""</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;resources:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- nodes/metrics</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;verbs:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- get</span></div><div><span style="font-size: 18pt;">- apiGroups:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- ""</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;resources:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- pods</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- nodes</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;verbs:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- get</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- list</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- watch</span></div><div><span style="font-size: 18pt;">---</span></div><div><span style="font-size: 18pt;">apiVersion: rbac.authorization.k8s.io/v1</span></div><div><span style="font-size: 18pt;">kind: RoleBinding</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;labels:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k8s-app: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: metrics-server-auth-reader</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;namespace: kube-system</span></div><div><span style="font-size: 18pt;">roleRef:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;apiGroup: rbac.authorization.k8s.io</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;kind: Role</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: extension-apiserver-authentication-reader</span></div><div><span style="font-size: 18pt;">subjects:</span></div><div><span style="font-size: 18pt;">- kind: ServiceAccount</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;namespace: kube-system</span></div><div><span style="font-size: 18pt;">---</span></div><div><span style="font-size: 18pt;">apiVersion: rbac.authorization.k8s.io/v1</span></div><div><span style="font-size: 18pt;">kind: ClusterRoleBinding</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;labels:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k8s-app: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: metrics-server:system:auth-delegator</span></div><div><span style="font-size: 18pt;">roleRef:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;apiGroup: rbac.authorization.k8s.io</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;kind: ClusterRole</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: system:auth-delegator</span></div><div><span style="font-size: 18pt;">subjects:</span></div><div><span style="font-size: 18pt;">- kind: ServiceAccount</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;namespace: kube-system</span></div><div><span style="font-size: 18pt;">---</span></div><div><span style="font-size: 18pt;">apiVersion: rbac.authorization.k8s.io/v1</span></div><div><span style="font-size: 18pt;">kind: ClusterRoleBinding</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;labels:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k8s-app: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: system:metrics-server</span></div><div><span style="font-size: 18pt;">roleRef:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;apiGroup: rbac.authorization.k8s.io</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;kind: ClusterRole</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: system:metrics-server</span></div><div><span style="font-size: 18pt;">subjects:</span></div><div><span style="font-size: 18pt;">- kind: ServiceAccount</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;namespace: kube-system</span></div><div><span style="font-size: 18pt;">---</span></div><div><span style="font-size: 18pt;">apiVersion: v1</span></div><div><span style="font-size: 18pt;">kind: Service</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;labels:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k8s-app: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;namespace: kube-system</span></div><div><span style="font-size: 18pt;">spec:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;ports:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;- name: https</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port: 443</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol: TCP</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;targetPort: https</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;selector:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k8s-app: metrics-server</span></div><div><span style="font-size: 18pt;">---</span></div><div><span style="font-size: 18pt;">apiVersion: apps/v1</span></div><div><span style="font-size: 18pt;">kind: Deployment</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;labels:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k8s-app: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;namespace: kube-system</span></div><div><span style="font-size: 18pt;">spec:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;selector:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matchLabels:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k8s-app: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;strategy:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rollingUpdate:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxUnavailable: 0</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;template:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;labels:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k8s-app: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spec:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;containers:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- args:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- --cert-dir=/tmp</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- --secure-port=4443</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- --kubelet-use-node-status-port</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- --metric-resolution=15s</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image:&nbsp;&nbsp;</span><span style="font-size: 18pt;">&nbsp;&nbsp;bitnami/metrics-server:0.6.1-debian-11-r38</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imagePullPolicy: IfNotPresent</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;livenessProbe:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failureThreshold: 3</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;httpGet:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /livez</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port: https</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scheme: HTTPS</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;periodSeconds: 10</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ports:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- containerPort: 4443</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: https</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protocol: TCP</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readinessProbe:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failureThreshold: 3</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;httpGet:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path: /readyz</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port: https</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scheme: HTTPS</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initialDelaySeconds: 20</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;periodSeconds: 10</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resources:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;requests:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cpu: 100m</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memory: 200Mi</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;securityContext:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allowPrivilegeEscalation: false</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readOnlyRootFilesystem: true</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;runAsNonRoot: true</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;runAsUser: 1000</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;volumeMounts:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- mountPath: /tmp</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: tmp-dir</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nodeSelector:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kubernetes.io/os: linux</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;priorityClassName: system-cluster-critical</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;serviceAccountName: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;volumes:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- emptyDir: {}</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: tmp-dir</span></div><div><span style="font-size: 18pt;">---</span></div><div><span style="font-size: 18pt;">apiVersion: apiregistration.k8s.io/v1</span></div><div><span style="font-size: 18pt;">kind: APIService</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;labels:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k8s-app: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: v1beta1.metrics.k8s.io</span></div><div><span style="font-size: 18pt;">spec:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;group: metrics.k8s.io</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;groupPriorityMinimum: 100</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;insecureSkipTLSVerify: true</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;service:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name: metrics-server</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;namespace: kube-system</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;version: v1beta1</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;versionPriority: 100</span></div><div><span style="font-size: 24pt;">2.设置kubernetes 账号 (保存yml格式文件 并且执行</span><span style="font-size: 24pt;">kubectl apply -f xxxx.yml</span><span style="font-size: 24pt;">)</span></div><div><br/></div><div><span style="font-size: 18pt;">apiVersion: v1</span></div><div><span style="font-size: 18pt;">kind: ServiceAccount</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: admin-user</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;namespace: kube-system</span></div><div><span style="font-size: 18pt;">---</span></div><div><span style="font-size: 18pt;">apiVersion: rbac.authorization.k8s.io/v1</span></div><div><span style="font-size: 18pt;">kind: ClusterRoleBinding</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: admin-user</span></div><div><span style="font-size: 18pt;">roleRef:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;apiGroup: rbac.authorization.k8s.io</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;kind: ClusterRole</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: cluster-admin</span></div><div><span style="font-size: 18pt;">subjects:</span></div><div><span style="font-size: 18pt;">- kind: ServiceAccount</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: admin-user</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;namespace: kube-system</span></div><div><span style="font-size: 24pt;">3 创建dashboard 命名空间</span></div><div><span style="font-size: 24pt;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: unset; font-family: unset; font-size: 18pt;">kubectl&nbsp;&nbsp;&nbsp;&nbsp;create namespace kubernetes-dashboard</span></div><div><span style="font-size: 24pt; color: unset; font-family: unset;">4&nbsp;&nbsp;</span><span style="font-size: 24pt;">dashboard 开启访问端口</span></div><div><span style="font-size: 18pt;">kind: Service</span></div><div><span style="font-size: 18pt;">apiVersion: v1</span></div><div><span style="font-size: 18pt;">metadata:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;name: kubernetes-dashboard</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;namespace: kubernetes-dashboard</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;labels:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k8s-app: kubernetes-dashboard</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kubernetes.io/cluster-service: 'true'</span></div><div><font style="font-size: 18pt;"><br/></font></div><div><span style="font-size: 18pt;">spec:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;ports:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- protocol: TCP</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port: 80</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;targetPort: 8443</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nodePort: 32079</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;selector:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k8s-app: kubernetes-dashboard</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;type: NodePort</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;sessionAffinity: None</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;externalTrafficPolicy: Cluster</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;ipFamilies:</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- IPv4</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;ipFamilyPolicy: SingleStack</span></div><div><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;internalTrafficPolicy: Cluster</span></div><div><span style="font-size: 18pt;">5.问题处理</span></div><div><span style="font-size: 18pt;"><img src="8.%20kubernetes%20dashboard%20%E6%8E%A7%E5%88%B6%E5%8F%B0%E7%A7%81%E6%9C%89%E5%8C%96%E9%83%A8%E7%BD%B2.resources/799BACCD-07EE-45AA-A1FA-EA407AAC44D5.png" height="742" width="1435"/></span></div><div><span style="font-size: 18pt;">如果dashboard无法访问查看日志发现是metrics-server无法访问，重启一下dashboard可以</span></div><div><br/></div></body></html>